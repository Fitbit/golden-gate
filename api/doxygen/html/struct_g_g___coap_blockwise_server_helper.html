<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Golden Gate: GG_CoapBlockwiseServerHelper Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Golden Gate
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="struct_g_g___coap_blockwise_server_helper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">GG_CoapBlockwiseServerHelper Struct Reference<div class="ingroups"><a class="el" href="group___co_a_p.html">CoAP</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="gg__coap__blockwise_8h_source.html">xp/coap/gg_coap_blockwise.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a61147ea3f1b9a4f8eda98e0335ed2586"><td class="memItemLeft" align="right" valign="top"><a id="a61147ea3f1b9a4f8eda98e0335ed2586"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_g___coap_blockwise_server_helper.html#a61147ea3f1b9a4f8eda98e0335ed2586">block_type</a></td></tr>
<tr class="memdesc:a61147ea3f1b9a4f8eda98e0335ed2586"><td class="mdescLeft">&#160;</td><td class="mdescRight">GG_COAP_MESSAGE_OPTION_BLOCK1 or GG_COAP_MESSAGE_OPTION_BLOCK2. <br /></td></tr>
<tr class="separator:a61147ea3f1b9a4f8eda98e0335ed2586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f56f92a8356769c6e40e67e100183c6"><td class="memItemLeft" align="right" valign="top"><a id="a8f56f92a8356769c6e40e67e100183c6"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_g___coap_blockwise_server_helper.html#a8f56f92a8356769c6e40e67e100183c6">next_offset</a></td></tr>
<tr class="memdesc:a8f56f92a8356769c6e40e67e100183c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Next expected block offset. <br /></td></tr>
<tr class="separator:a8f56f92a8356769c6e40e67e100183c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adca8787b7ca20c9ccaaa3e66914ab5f3"><td class="memItemLeft" align="right" valign="top"><a id="adca8787b7ca20c9ccaaa3e66914ab5f3"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_g___coap_blockwise_server_helper.html#adca8787b7ca20c9ccaaa3e66914ab5f3">done</a></td></tr>
<tr class="memdesc:adca8787b7ca20c9ccaaa3e66914ab5f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">True when we've received the last block. <br /></td></tr>
<tr class="separator:adca8787b7ca20c9ccaaa3e66914ab5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff626ebd03378082181abfa82a58eb78"><td class="memItemLeft" align="right" valign="top"><a id="aff626ebd03378082181abfa82a58eb78"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_g___coap_blockwise_server_helper.html#aff626ebd03378082181abfa82a58eb78">preferred_block_size</a></td></tr>
<tr class="memdesc:aff626ebd03378082181abfa82a58eb78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Preferred block size. <br /></td></tr>
<tr class="separator:aff626ebd03378082181abfa82a58eb78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a940992744e13e8212691430e6d5d42b8"><td class="memItemLeft" align="right" valign="top"><a id="a940992744e13e8212691430e6d5d42b8"></a>
<a class="el" href="struct_g_g___coap_message_block_info.html">GG_CoapMessageBlockInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_g___coap_blockwise_server_helper.html#a940992744e13e8212691430e6d5d42b8">block_info</a></td></tr>
<tr class="memdesc:a940992744e13e8212691430e6d5d42b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last parsed BLOCK1 option. <br /></td></tr>
<tr class="separator:a940992744e13e8212691430e6d5d42b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab60f0463b1e388053dfc63f0b560085f"><td class="memItemLeft" align="right" valign="top"><a id="ab60f0463b1e388053dfc63f0b560085f"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_g___coap_blockwise_server_helper.html#ab60f0463b1e388053dfc63f0b560085f">etag</a> [<a class="el" href="group___co_a_p.html#gaa4f5ba5ff2d6f69943d26ce6ee233f44">GG_COAP_MESSAGE_MAX_ETAG_OPTION_SIZE</a>]</td></tr>
<tr class="memdesc:ab60f0463b1e388053dfc63f0b560085f"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETag for the transfer session. <br /></td></tr>
<tr class="separator:ab60f0463b1e388053dfc63f0b560085f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cdaed62d9428a81c5bf6d74b5bb4fc"><td class="memItemLeft" align="right" valign="top"><a id="af9cdaed62d9428a81c5bf6d74b5bb4fc"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_g___coap_blockwise_server_helper.html#af9cdaed62d9428a81c5bf6d74b5bb4fc">etag_size</a></td></tr>
<tr class="memdesc:af9cdaed62d9428a81c5bf6d74b5bb4fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETag size. <br /></td></tr>
<tr class="separator:af9cdaed62d9428a81c5bf6d74b5bb4fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Help object for handling blockwise request. This object is a helper for CoAP server handlers that support BLOCK1 blockwise transfers (i.e PUT or POST requests with large payloads) or BLOCK2 blockwise transfers (i.e GET request with large payloads). This object maintains the current state of a blockwise transfer. This includes the next expected request's block offset, as well as an ETag value used to differentiate between different transfers. Only one transfer can be active at a time. When a request is received, the helper can check if the request is a resent request (the block range is just before the current one) or a new request for the next block.</p>
<p>A typical use for this helper is: In the OnRequest() method of a CoAP server handler, when a request is received, call <a class="el" href="group___co_a_p.html#ga018dd696dea3da3c5118f863826cf620">GG_CoapBlockwiseServerHelper_OnRequest()</a> to analyze the request and check that it matches the current expectations. If that method returns an error the handler should terminate and return that error. Otherwise, the handler should check if the requested block is the first block (block 0) of a new transfer (<code>helper.block_info.offset == 0</code>). If it is a new transfer, the handler should set the helper's ETag value to differentiate this new transfer from previous ones, by calling <a class="el" href="group___co_a_p.html#gad64be36befdaccfbf2975be97bf3afcd">GG_CoapBlockwiseServerHelper_SetEtag()</a>.</p>
<p>NOTE: unfortunately, there's no way to differentiate a new request for block 0 and a retransmitted block 0 request, because for block 0, the ETag value isn't yet known to the client. But that isn't an issue in general, because a retransmitted block 0 would simply start a new session just after the one started by the initial block 0 request.</p>
<p>Finally, the handler should: for BLOCK1 PUT/POST transfers, save/handle/process the block's payload if the block isn't a resent block, or for BLOCK2 GET transfers, prepare the block payload to respond with, then call <a class="el" href="group___co_a_p.html#ga6c30a370f572f4ffafc6a8d906436cdf">GG_CoapBlockwiseServerHelper_CreateResponse()</a> to create and return a response. (the call to <a class="el" href="group___co_a_p.html#ga018dd696dea3da3c5118f863826cf620">GG_CoapBlockwiseServerHelper_OnRequest()</a> returns a boolean flag that indicates whether the request is a new request or a resent request).</p>
<p>NOTE: the handler must be prepared to receive the same block request more than once, because transmissions may be lost. The helper object will guarantee that the block requests are never out of order or with gaps, but repeated sequential requests for the same block are possible. For PUT/POST requests, simply ignoring resent blocks is usually sufficient. For GET requests, the handler may want to cache the last returned block if it can't re-generate the block payload. </p>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>xp/coap/<a class="el" href="gg__coap__blockwise_8h_source.html">gg_coap_blockwise.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
